{
    "contents" : "require(ISLR)\nrequire(boot)\n?cv.glm\nplot(mpg~horsepower,data=Auto)\n\n## LOOCV\nglm.fit=glm(mpg~horsepower, data=Auto)\ncv.glm(Auto,glm.fit)$delta #pretty slow (doesnt use formula (5.2) on page 180)\n\n##Lets write a simple function to use formula (5.2)\nloocv=function(fit){\n  h=lm.influence(fit)$h\n  mean((residuals(fit)/(1-h))^2)\n}\n\n## Now we try it out\nloocv(glm.fit)\n\n\ncv.error=rep(0,5)\ndegree=1:5\nfor(d in degree){\n  glm.fit=glm(mpg~poly(horsepower,d), data=Auto)\n  cv.error[d]=loocv(glm.fit)\n}\nplot(degree,cv.error,type=\"b\")\n\n## 10-fold CV\n\ncv.error10=rep(0,5)\nfor(d in degree){\n  glm.fit=glm(mpg~poly(horsepower,d), data=Auto)\n  cv.error10[d]=cv.glm(Auto,glm.fit,K=10)$delta[1]\n}\nlines(degree,cv.error10,type=\"b\",col=\"red\")\n\n\n## Bootstrap\n## Minimum risk investment - Section 5.2\n\nalpha=function(x,y){\n  vx=var(x)\n  vy=var(y)\n  cxy=cov(x,y)\n  (vy-cxy)/(vx+vy-2*cxy)\n}\nalpha(Portfolio$X,Portfolio$Y)\n\n## What is the standard error of alpha?\n\nalpha.fn=function(data, index){\n  with(data[index,],alpha(X,Y))\n}\n\nalpha.fn(Portfolio,1:100)\n\nset.seed(1)\nalpha.fn (Portfolio,sample(1:100,100,replace=TRUE))\n\nboot.out=boot(Portfolio,alpha.fn,R=1000)\nboot.out\nplot(boot.out)\n",
    "created" : 1435259608182.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2969560636",
    "id" : "195C16E4",
    "lastKnownWriteTime" : 1435167348,
    "path" : "~/stanford_stat_learning/ch5_resampling.R",
    "project_path" : "ch5_resampling.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}