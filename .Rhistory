filt_shift_2[21:length(filt_shift_2)])
View(shift_mat)
filt=runmed(round(runmed(step_noise,filter_window)),filter_window)
plot(filt)
filter_window=51
filt=runmed(round(runmed(step_noise,filter_window)),11)
plot(filt)
plot(filt)
filter_window=51
filt=runmed(round(runmed(step_noise,filter_window)),11)
filt=round(runmed(step_noise,filter_window))
plot(filt)
shift_mat=cbind(filt,
filt[10:length(filt)],
filt[20:length(filt)]
)
View(shift_mat)
filt[10:length(filt),rep(median(filt[(length(filt)-10):length(filt)]),10),
filt[10:length(filt),rep(median(filt[(length(filt)-10):length(filt)]),10)
]
rep(median(filt[(length(filt)-10):length(filt)]),10)
shift_mat=cbind(filt,
c(filt[10:length(filt)],rep(median(filt[(length(filt)-10):length(filt)]),10)),
c(filt[20:length(filt)],rep(median(filt[(length(filt)-20):length(filt)]),20))
)
length(filt)
length(c(filt[10:length(filt)],rep(median(filt[(length(filt)-10):length(filt)]),10)))
shift_mat=cbind(filt,
c(filt[10:length(filt)],rep(median(filt[(length(filt)-10):length(filt)]),9)),
c(filt[20:length(filt)],rep(median(filt[(length(filt)-20):length(filt)]),10))
)
length(c(filt[10:length(filt)],rep(median(filt[(length(filt)-10):length(filt)]),9)))
length(c(filt[20:length(filt)],rep(median(filt[(length(filt)-20):length(filt)]),10)))
shift_mat=cbind(filt,
c(filt[10:length(filt)],rep(median(filt[(length(filt)-10):length(filt)]),9)),
c(filt[20:length(filt)],rep(median(filt[(length(filt)-20):length(filt)]),19))
)
View(shift_mat)
a=apply(shift_mat,1,median)
plot(a,type="p")
length(c(rep(median(filt[1:10]),9),filt[1:(length(filt)-10)]))
shift_mat=cbind(c(rep(median(filt[1:20]),20),filt[1:(length(filt)-20)])
c(rep(median(filt[1:10]),10),filt[1:(length(filt)-10)])
filt,
c(filt[10:length(filt)],rep(median(filt[(length(filt)-10):length(filt)]),9)),
shift_mat=cbind(c(rep(median(filt[1:20]),20),filt[1:(length(filt)-20)]),
c(rep(median(filt[1:10]),10),filt[1:(length(filt)-10)]),
filt,
c(filt[10:length(filt)],rep(median(filt[(length(filt)-10):length(filt)]),9)),
c(filt[20:length(filt)],rep(median(filt[(length(filt)-20):length(filt)]),19))
)
View(shift_mat)
a=apply(shift_mat,1,median)
plot(a,type="p")
plot(filt)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
plot(filt)
plot(filt)
plot(runmed(filt,filter_window))
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
plot(round(unstep_noise),type="p")
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
bad_ind=which(round(unstep_noise)==-1)
bad_ind
unstep_noise[bad_ind]=unstep_noise[bad_ind]+1
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
hist(round(unstep_noise))
hist(unstep_noise)
len=1000
noise=rnorm(len,-.1,.1)
good_vec=rep(c(0,1,0,0),len/4)
noise_vec=good_vec+noise
plot(noise_vec)
steps=round(rnorm(10,-1,1))
t=sapply(steps,function(x) x*rep(1,100))
steps_10=NULL
for(i in 1:ncol(t)) steps_10=c(steps_10,t[,i])
step_noise=noise_vec+steps_10
plot(step_noise)
steps_10
steps
filter_window=51
filt=round(runmed(step_noise,filter_window))
plot(filt)
filt=round(runmed(filt,10))
filt=round(runmed(filt,11))
plot(filt)
filt=round(runmed(filt,11))
plot(filt)
filt=round(runmed(filt,11))
plot(filt)
filt=round(runmed(filt,11))
plot(filt)
filt=round(runmed(filt,11))
plot(filt)
filt2=round(runmed(filt,11))
summary(filt-filt2)
filter_window=51
filt=(runmed(step_noise,filter_window))
plot(filt)
filt=(runmed(filt,11))
plot(filt)
filt=(runmed(filt,11))
plot(filt)
filt=(runmed(filt,11))
plot(filt)
filt=(runmed(filt,11))
plot(filt)
filt=(runmed(filt,3))
plot(filt)
filt=(runmed(filt,3))
plot(filt)
filt=round(runmed(step_noise,filter_window))
plot(filt)
filt=(runmed(filt,3))
plot(filt)
filt=round(runmed(step_noise,filter_window))
filt2=(runmed(filt,3))
sum(diff(filt,filt2))
summary(filt-filt2)
filt=round(runmed(step_noise,filter_window))
filt2=(runmed(filt,3))
summary(filt-filt2)
filt=(runmed(step_noise,filter_window))
filt2=(runmed(filt,3))
summary(filt-filt2)
plot(filt)
filter_window=21
filt=(runmed(step_noise,filter_window))
plot(filt)
filt2=(runmed(filt,3))
summary(filt-filt2)
plot(filt)
filt=(runmed(filt,3))
plot(filt)
filt=(runmed(filt,3))
plot(filt)
plot(filt)
unstep_noise=step_noise-filt
unstep_noise=step_noise-filt
filt=(runmed(filt,3))
plot(filt)
filter_window=3
filt=(runmed(step_noise,filter_window))
plot(filt)
filt=(runmed(filt,3))
plot(filt)
filt=(runmed(filt,3))
plot(filt)
filt=(runmed(filt,3))
plot(filt)
filt=(runmed(filt,3))
plot(filt)
filt=(runmed(filt,3))
plot(filt)
filt=(runmed(filt,3))
plot(filt)
filter_window=3
filt=round((runmed(step_noise,filter_window)))
plot(filt)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
bad_ind=which(round(unstep_noise)==-1)
bad_ind
unstep_noise[bad_ind]=unstep_noise[bad_ind]+1
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
hist(unstep_noise)
lines(round(unstep_noise),type="p")
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
filter_window=3
filt=round((runmed(step_noise,filter_window)))
plot(filt)
filt=((runmed(step_noise,filter_window)))
plot(filt)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
filter_window=3
filt=((runmed(step_noise,filter_window)))
plot(filt)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
plot(step_noise)
filt=((runmed(step_noise,filter_window)))
filt=runmed(step_noise,filter_window)
plot(filt)
?runmed
?runmean
filter_window=3
filt=runmed(filter(step_noisex,rep(1/filter_window,filter_window),filter_window)
plot(filt)
filter(step_noisex,rep(1/filter_window,filter_window)
filt=runmed(filter(step_noisex,rep(1/filter_window,filter_window)),filter_window)
filt=runmed(filter(step_noise,rep(1/filter_window,filter_window)),filter_window)
filter_window=5
filt=runmed(step_noise,filter_window)
plot(filt)
filt=runmed(filt,filter_window-2)
plot(filt)
filt=runmed(filt,filter_window-2)
plot(filt)
filt=runmed(filt,filter_window-2)
plot(filt)
filt=runmed(filt,filter_window-2)
plot(filt)
filt=runmed(filt,filter_window-2)
plot(filt)
filt=runmed(filt,filter_window-2)
plot(filt)
filt=runmed(filt,filter_window-2)
plot(filt)
filt=runmed(filt,filter_window-2)
plot(filt)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
plot(noise_vec)
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
bad_ind=which(round(unstep_noise)==-1)
unstep_noise[bad_ind]=unstep_noise[bad_ind]+1
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
plot(unstep_noise,type="p")
plot(noise_vec)
plot(unstep_noise,type="p")
filt=runmed(step_noise,filter_window)
plot(filt)
filt=runmed(round(step_noise),filter_window)
plot(filt)
steps
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
plot(filt)
plot(unstep_noise,type="p")
lines(round(unstep_noise),type="p")
plot(unstep_noise,type="p")
bad_ind=which(round(unstep_noise)==-1)
bad_ind
unstep_noise[bad_ind]=unstep_noise[bad_ind]+1
plot(unstep_noise,type="p")
plot(noise_vec)
plot(unstep_noise,type="p")
plot(unstep_noise,type="p")
plot(noise_vec)
summary(unstep_noise!=unstep_noise)
sum(which(unstep_noise!=unstep_noise))
sum(which(unstep_noise!=unstep_noise))
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
sum(which(unstep_noise!=unstep_noise))
plot(filt)
plot(unstep_noise,type="p")
sum(which(unstep_noise!=noise_vec))
plot(unstep_noise,type="p")
plot(noise_vec)
plot(unstep_noise,type="p")
plot(noise_vec)
sum(which(unstep_noise!=noise_vec))
plot(unstep_noise,type="p")
plot(noise_vec)
bad_ind=which(round(unstep_noise)==-1)
unstep_noise[bad_ind]=unstep_noise[bad_ind]+1
plot(unstep_noise,type="p")
plot(noise_vec)
sum(which(unstep_noise!=noise_vec))
plot(unstep_noise,type="p")
plot(noise_vec)
sum(abs(unstep_noise-noise_vec))
sum(abs(round(unstep_noise)-round(noise_vec)))
len=1000
noise=rnorm(len,-.1,.1)
good_vec=rep(c(0,1,0,0),len/4)
noise_vec=good_vec+noise
plot(noise_vec)
steps=round(rnorm(10,-1,1))
t=sapply(steps,function(x) x*rep(1,100))
steps_10=NULL
for(i in 1:ncol(t)) steps_10=c(steps_10,t[,i])
step_noise=noise_vec+steps_10
plot(step_noise)
filter_window=5
filt=runmed(round(step_noise),filter_window)
plot(filt)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
bad_ind=which(round(unstep_noise)==-1)
unstep_noise[bad_ind]=unstep_noise[bad_ind]+1
plot(unstep_noise,type="p")
plot(noise_vec)
sum(abs(unstep_noise-noise_vec))
sum(abs(round(unstep_noise)-round(noise_vec)))
plot(unstep_noise,type="p")
plot(noise_vec)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
bad_ind=which(round(unstep_noise)==-1)
unstep_noise[bad_ind]=unstep_noise[bad_ind]+1
plot(unstep_noise,type="p")
plot(noise_vec)
sum(abs(unstep_noise-noise_vec))
sum(abs(round(unstep_noise)-round(noise_vec)))
len=1000
noise=rnorm(len,-.1,.1)
good_vec=rep(c(0,1,0,0),len/4)
noise_vec=good_vec+noise
plot(noise_vec)
steps=round(rnorm(20,-1,1))
t=sapply(steps,function(x) x*rep(1,50))
steps_10=NULL
for(i in 1:ncol(t)) steps_10=c(steps_10,t[,i])
step_noise=noise_vec+steps_10
plot(step_noise)
steps
filter_window=5
filt=runmed(round(step_noise),filter_window)
plot(filt)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
bad_ind=which(round(unstep_noise)==-1)
unstep_noise[bad_ind]=unstep_noise[bad_ind]+1
plot(unstep_noise,type="p")
plot(noise_vec)
plot(unstep_noise,type="p")
plot(noise_vec)
sum(abs(unstep_noise-noise_vec))
sum(abs(unstep_noise-noise_vec))
sum(abs(round(unstep_noise)-round(noise_vec)))
plot(unstep_noise,type="p")
plot(noise_vec)
sum(abs(unstep_noise-noise_vec))
sum(abs(round(unstep_noise)-round(noise_vec)))
require(ISLR)
names(Smarket)
summary(Smarket)
?Smarket
pairs(Smarket,col=Smarket$Direction)
glm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,
data=Smarket,family=binomial)
summary(glm.fit)
names(Smarket)
summary(Smarket)
glm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,
data=Smarket,family=binomial)
glm.probs=predict(glm.fit,type="response")
glm.probs[1:5]
glm.pred=ifelse(glm.probs>0.5,"Up","Down")
attach(Smarket)
table(glm.pred,Direction)
mean(glm.pred==Direction)
train = Year<2005
glm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,
data=Smarket,family=binomial, subset=train)
glm.probs=predict(glm.fit,newdata=Smarket[!train,],type="response")
glm.pred=ifelse(glm.probs >0.5,"Up","Down")
Direction.2005=Smarket$Direction[!train]
table(glm.pred,Direction.2005)
mean(glm.pred==Direction.2005)
glm.fit=glm(Direction~Lag1+Lag2,
data=Smarket,family=binomial, subset=train)
glm.probs=predict(glm.fit,newdata=Smarket[!train,],type="response")
glm.pred=ifelse(glm.probs >0.5,"Up","Down")
table(glm.pred,Direction.2005)
mean(glm.pred==Direction.2005)
106/(76+106)
require(MASS)
len=1000
noise=rnorm(len,-.1,.1)
good_vec=rep(c(0,1,0,0),len/4)
noise_vec=good_vec+noise
plot(noise_vec)
steps=round(rnorm(20,-1,1))
t=sapply(steps,function(x) x*rep(1,50))
steps_10=NULL
for(i in 1:ncol(t)) steps_10=c(steps_10,t[,i])
step_noise=noise_vec+steps_10
plot(step_noise)
filter_window=5
filt=runmed(round(step_noise),filter_window)
plot(filt)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
bad_ind=which(round(unstep_noise)==-1)
unstep_noise[bad_ind]=unstep_noise[bad_ind]+1
plot(unstep_noise,type="p")
plot(noise_vec)
sum(abs(unstep_noise-noise_vec))
sum(abs(round(unstep_noise)-round(noise_vec)))
plot(unstep_noise,type="p")
plot(noise_vec)
plot(unstep_noise,type="p")
plot(noise_vec)
sum(abs(unstep_noise-noise_vec))
sum(abs(round(unstep_noise)-round(noise_vec)))
bad_ind
bad_ind
len=1000
noise=rnorm(len,-.1,.1)
good_vec=rep(c(0,1,0,0),len/4)
noise_vec=good_vec+noise
plot(noise_vec)
steps=round(rnorm(20,-1,1))
t=sapply(steps,function(x) x*rep(1,50))
steps_10=NULL
for(i in 1:ncol(t)) steps_10=c(steps_10,t[,i])
step_noise=noise_vec+steps_10
plot(step_noise)
steps
t=sapply(steps,function(x) x*rep(1,50))
steps_10=NULL
for(i in 1:ncol(t)) steps_10=c(steps_10,t[,i])
step_noise=noise_vec+steps_10
plot(step_noise)
filter_window=5
filt=runmed(round(step_noise),filter_window)
plot(filt)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
plot(step_noise)
table(cut(step_noise,20)
)
df=data.frame(x=1:len,y=step_noise)
table(cut(df$x,20))
fit=lm(df$y~cut(df$x,20))
fit
steps
fit=lm(df$y~0+cut(df$x,20))
fit
steps
coeff(summary(fit))
coef(summary(fit))
coef(summary(fit))[1]
coef(summary(fit))[,1]
round(coef(summary(fit))[,1])
steps
as.vector(round(coef(summary(fit))[,1]))
bad_ind=which(round(unstep_noise)==-1)
unstep_noise[bad_ind]=unstep_noise[bad_ind]+1
plot(unstep_noise,type="p")
plot(noise_vec)
sum(abs(unstep_noise-noise_vec))
sum(abs(round(unstep_noise)-round(noise_vec)))
as.vector((coef(summary(fit))[,1]))
step_fit=as.vector((coef(summary(fit))[,1]))
step_fit=as.vector((coef(summary(fit))[,1]))
step_fit
steps
step_fit=as.vector((coef(summary(fit))[,1]))
step_fit
t=sapply(step_fit,function(x) x*rep(1,50))
length(t)
steps_10=NULL
for(i in 1:ncol(t)) steps_10=c(steps_10,t[,i])
unstep_noise=step_noise-steps_10
plot(step_noise)
plot(noise_vec)
plot(unstep_noise)
plot(noise_vec)
plot(unstep_noise)
plot(noise_vec)
len=1000
noise=rnorm(len,-.1,.1)
good_vec=rep(c(0,1,0,0),len/4)
noise_vec=good_vec+noise
plot(noise_vec)
steps=round(rnorm(20,-1,1))
t=sapply(steps,function(x) x*rep(1,50))
steps_10=NULL
for(i in 1:ncol(t)) steps_10=c(steps_10,t[,i])
step_noise=noise_vec+steps_10
plot(step_noise)
filter_window=5
filt=runmed(round(step_noise),filter_window)
plot(filt)
filt=runmed((step_noise),filter_window)
plot(filt)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
filter_window=5
filt=runmed((step_noise),filter_window)
plot(filt)
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
bad_ind=which(round(unstep_noise)==-1)
bad_ind
plot(filt)
title("note the averaging issue between steps")
unstep_noise=step_noise-filt
plot(unstep_noise,type="p")
plot(unstep_noise,type="p")
plot(noise_vec)
df=data.frame(x=1:len,y=step_noise)
fit=lm(df$y~0+cut(df$x,20))
step_fit=as.vector((coef(summary(fit))[,1]))
step_fit
step_fit=as.vector((coef(summary(fit))[,1]))
t=sapply(step_fit,function(x) x*rep(1,50))
steps_10=NULL
steps_10=NULL
for(i in 1:ncol(t)) steps_10=c(steps_10,t[,i])
unstep_noise=step_noise-steps_10
plot(unstep_noise)
